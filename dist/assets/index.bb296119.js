import{y as z,z as H,m as M,q as j}from"./fetch.0f22f1f0.js";/* empty css                   *//* empty css                           *//* empty css                     *//* empty css                  *//* empty css                  *//* empty css                  *//* empty css                   */import{h as G,f as J,i as E,j as f,Y as K,Z as O,A as T,B as Y,a3 as Z,a4 as $,r as P,m as Q,D as W,a2 as X,G as ee,o as n,I as m,a,w as r,H as te,c as b,u as o,J as ae,M as A,N as x,ac as le,K as u,R as B}from"./vendor.9ce32bbf.js";import{e as C}from"./functions.4004cecb.js";import{_ as oe}from"./plugin-vue_export-helper.21dcd24c.js";import"./index.483ec574.js";const re={class:"editArticle"},se=u("\u9996\u9875"),ie=u("\u6587\u7AE0\u7BA1\u7406"),ne=u("\u6587\u7AE0\u5217\u8868"),de=u("\u6DFB\u52A0\u6587\u7AE0"),ue={class:"category_label"},_e=["src"],ce=u("\u7ACB\u5373\u4FEE\u6539"),me=u("\u91CD\u7F6E"),pe={setup(ge){const h=G(),q=J(),p=E(!0),v=E(),c=f({btn:!1}),e=f({req:{title:"",category_id:"",label_ids:"",img_url:"",content:"",img_source:""},categories:[],labels:[],rules:{title:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898",trigger:"blur"}],category_id:[{required:!0,message:"\u8BF7\u9009\u62E9\u5206\u7C7B",trigger:"blur"}],img_url:[{required:!0,message:"\u8BF7\u8F93\u5165\u56FE\u7247\u5730\u5740",trigger:"blur"}],img_source:[{required:!0,message:"\u8BF7\u8F93\u5165\u56FE\u7247\u6765\u6E90",trigger:"blur"}],content:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9",trigger:"blur"}]}});f({Authorization:window.sessionStorage.getItem("token")?window.sessionStorage.getItem("token"):""});const I=async()=>{const s=await M();s.status===200&&s.ok&&(e.categories=s.data.data)},U=async()=>{const s=await j();s.status===200&&s.ok&&(e.labels=s.data.data)},y=async()=>{p.value=!0;const s=q.query.id,t=await z(s);t.status===200&&t.ok&&(e.req=t.data.data,await U(),await I(),p.value=!1,e.req.category_id=await C(e.req.category_id,e.categories)?t.data.data.category_id:"",e.req.label_ids=await C(e.req.label_ids,e.labels)?t.data.data.label_ids:[])};y();const F=s=>{!s||s.validate(async t=>{if(t){const d=q.query.id;c.btn=!0;const _=await H(d,e.req);_.status===200&&_.ok?(B.success("\u4FEE\u6539\u6210\u529F"),c.btn=!1,h.push({name:"Articles"})):(c.btn=!1,B.error(_.data.message))}})},L=s=>{y()};return(s,t)=>{const d=K,_=O,g=T,i=Y,V=Z,w=$,N=P("v-md-editor"),k=Q,D=W,R=X,S=ee;return n(),m("div",re,[a(_,{"separator-class":"el-icon-arrow-right"},{default:r(()=>[a(d,{to:{name:"Home"}},{default:r(()=>[se]),_:1}),a(d,null,{default:r(()=>[ie]),_:1}),a(d,{to:{name:"Articles"}},{default:r(()=>[ne]),_:1}),a(d,null,{default:r(()=>[de]),_:1})]),_:1}),a(R,null,{default:r(()=>[te((n(),b(D,{ref_key:"Editform",ref:v,model:o(e).req,"label-width":"80px",rules:o(e).rules},{default:r(()=>[a(i,{label:"\u6807\u9898",prop:"title"},{default:r(()=>[a(g,{modelValue:o(e).req.title,"onUpdate:modelValue":t[0]||(t[0]=l=>o(e).req.title=l)},null,8,["modelValue"])]),_:1}),ae("div",ue,[a(i,{label:"\u5206\u7C7B",prop:"category_id"},{default:r(()=>[a(w,{modelValue:o(e).req.category_id,"onUpdate:modelValue":t[1]||(t[1]=l=>o(e).req.category_id=l),placeholder:"\u8BF7\u9009\u62E9\u5206\u7C7B"},{default:r(()=>[(n(!0),m(A,null,x(o(e).categories,l=>(n(),b(V,{key:l._id,label:l.cat_name,value:l._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(i,{label:"\u6807\u7B7E"},{default:r(()=>[a(w,{modelValue:o(e).req.label_ids,"onUpdate:modelValue":t[2]||(t[2]=l=>o(e).req.label_ids=l),multiple:"",placeholder:"\u8BF7\u9009\u62E9\u6807\u7B7E"},{default:r(()=>[(n(!0),m(A,null,x(o(e).labels,l=>(n(),b(V,{key:l._id,label:l.name,value:l._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),a(i,{label:"\u56FE\u7247\u6765\u6E90",prop:"img_source"},{default:r(()=>[a(g,{modelValue:o(e).req.img_source,"onUpdate:modelValue":t[3]||(t[3]=l=>o(e).req.img_source=l)},null,8,["modelValue"])]),_:1}),a(i,{label:"\u56FE\u7247\u5730\u5740",prop:"img_url"},{default:r(()=>[a(g,{modelValue:o(e).req.img_url,"onUpdate:modelValue":t[4]||(t[4]=l=>o(e).req.img_url=l)},null,8,["modelValue"]),o(e).req.img_url?(n(),m("img",{key:0,src:o(e).req.img_url,class:"preview"},null,8,_e)):le("",!0)]),_:1}),a(i,{label:"\u5185\u5BB9",prop:"content"},{default:r(()=>[a(N,{modelValue:o(e).req.content,"onUpdate:modelValue":t[5]||(t[5]=l=>o(e).req.content=l),height:"400px"},null,8,["modelValue"])]),_:1}),a(i,null,{default:r(()=>[a(k,{type:"primary",onClick:t[6]||(t[6]=l=>F(v.value)),loading:o(c).btn},{default:r(()=>[ce]),_:1},8,["loading"]),a(k,{onClick:L},{default:r(()=>[me]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[S,p.value]])]),_:1})])}}};var Ce=oe(pe,[["__scopeId","data-v-5132dca8"]]);export{Ce as default};
