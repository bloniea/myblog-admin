import{p as F,j as L,k as q,i as U,X as h,Y as N,F as S,G as D,a2 as H,a3 as M,r as j,q as z,H as G,a1 as J,J as K,o as _,L as p,a as l,w as r,K as O,c as y,u as o,M as P,P as w,Q as x,aa as Q,N as m,f as c}from"./vendor.0ff88f1f.js";/* empty css                   *//* empty css                           *//* empty css                     *//* empty css                  *//* empty css                  *//* empty css                  */import{_ as R}from"./plugin-vue_export-helper.21dcd24c.js";const T={class:"editArticle"},X=m("\u9996\u9875"),Y=m("\u6587\u7AE0\u7BA1\u7406"),W=m("\u6587\u7AE0\u5217\u8868"),Z=m("\u6DFB\u52A0\u6587\u7AE0"),ee={class:"category_label"},te=["src"],ae=m("\u7ACB\u5373\u4FEE\u6539"),le=m("\u91CD\u7F6E"),re=m("\u53D6\u6D88"),oe={setup(se){const k=F(),n=L(!0),g=q({btn:!1}),e=q({req:{title:"",category_id:"",label_ids:"",img_url:"",content:"",img_source:""},category_id:[],label_ids:[],categories:[],labels:[],rules:{title:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898",trigger:"blur"}],category_id:[{required:!0,message:"\u8BF7\u9009\u62E9\u5206\u7C7B",trigger:"blur"}],img_url:[{required:!0,message:"\u8BF7\u8F93\u5165\u56FE\u7247\u5730\u5740",trigger:"blur"}],img_source:[{required:!0,message:"\u8BF7\u8F93\u5165\u56FE\u7247\u6765\u6E90",trigger:"blur"}],content:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9",trigger:"blur"}]}});q({Authorization:window.sessionStorage.getItem("token")?window.sessionStorage.getItem("token"):""});const{proxy:d}=U();(async()=>{n.value=!0;const s=d.$route.query.id,{data:t}=await d.$axios.get(`/adminApi/article/${s}`);if(t.meta.status!==200)return c.error(t.meta.msg);n.value=!1,e.req.title=t.data.title,e.req.category_id=t.data.category_id,e.req.label_ids=t.data.label_ids,e.req.img_url=t.data.img_url,e.req.content=t.data.content,e.req.img_source=t.data.img_source,e.category_id=t.data.category_id,(t.data.label_ids?t.data.label_ids.split(","):[]).forEach(b=>e.label_ids.push(parseInt(b)))})(),(async()=>{n.value=!0;const{data:s}=await d.$axios.get("/adminApi/categories");if(s.meta.status!==200)return c.error(s.meta.msg);e.categories=s.data,n.value=!1})(),(async()=>{n.value=!0;const{data:s}=await d.$axios.get("/adminApi/labels");if(s.meta.status!==200)return c.error(s.meta.msg);e.labels=s.data,n.value=!1})();const $=s=>{e.req.category_id=e.category_id.toString(),e.req.label_ids=e.label_ids.toString(),d.$refs[s].validate(async t=>{if(t){g.btn=!0;const{data:i}=await d.$axios.put(`/adminApi/articles/${d.$route.query.id}`,e.req);if(i.meta.status!==200)return g.btn=!1,c.error(i.meta.msg);c.success(i.meta.msg),g.btn=!1,k.push({name:"Articles"})}})};return(s,t)=>{const i=h,b=N,f=S,u=D,V=H,E=M,A=j("v-md-editor"),v=z,C=G,I=J,B=K;return _(),p("div",T,[l(b,{"separator-class":"el-icon-arrow-right"},{default:r(()=>[l(i,{to:{name:"Home"}},{default:r(()=>[X]),_:1}),l(i,null,{default:r(()=>[Y]),_:1}),l(i,{to:{name:"Articles"}},{default:r(()=>[W]),_:1}),l(i,null,{default:r(()=>[Z]),_:1})]),_:1}),l(I,null,{default:r(()=>[O((_(),y(C,{ref:"Editform",model:o(e).req,"label-width":"80px",rules:o(e).rules},{default:r(()=>[l(u,{label:"\u6807\u9898",prop:"title"},{default:r(()=>[l(f,{modelValue:o(e).req.title,"onUpdate:modelValue":t[0]||(t[0]=a=>o(e).req.title=a)},null,8,["modelValue"])]),_:1}),P("div",ee,[l(u,{label:"\u5206\u7C7B",prop:"category_id"},{default:r(()=>[l(E,{modelValue:o(e).category_id,"onUpdate:modelValue":t[1]||(t[1]=a=>o(e).category_id=a),placeholder:"\u8BF7\u9009\u62E9\u5206\u7C7B"},{default:r(()=>[(_(!0),p(w,null,x(o(e).categories,a=>(_(),y(V,{key:a.id,label:a.cat_name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"\u6807\u7B7E"},{default:r(()=>[l(E,{modelValue:o(e).label_ids,"onUpdate:modelValue":t[2]||(t[2]=a=>o(e).label_ids=a),multiple:"",placeholder:"\u8BF7\u9009\u62E9\u6807\u7B7E"},{default:r(()=>[(_(!0),p(w,null,x(o(e).labels,a=>(_(),y(V,{key:a.id,label:a.label_name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),l(u,{label:"\u56FE\u7247\u6765\u6E90",prop:"img_source"},{default:r(()=>[l(f,{modelValue:o(e).req.img_source,"onUpdate:modelValue":t[3]||(t[3]=a=>o(e).req.img_source=a)},null,8,["modelValue"])]),_:1}),l(u,{label:"\u56FE\u7247\u5730\u5740",prop:"img_url"},{default:r(()=>[l(f,{modelValue:o(e).req.img_url,"onUpdate:modelValue":t[4]||(t[4]=a=>o(e).req.img_url=a)},null,8,["modelValue"]),o(e).req.img_url?(_(),p("img",{key:0,src:o(e).req.img_url,class:"preview"},null,8,te)):Q("",!0)]),_:1}),l(u,{label:"\u5185\u5BB9",prop:"content"},{default:r(()=>[l(A,{modelValue:o(e).req.content,"onUpdate:modelValue":t[5]||(t[5]=a=>o(e).req.content=a),height:"400px"},null,8,["modelValue"])]),_:1}),l(u,null,{default:r(()=>[l(v,{type:"primary",onClick:t[6]||(t[6]=a=>$("Editform")),loading:o(g).btn},{default:r(()=>[ae]),_:1},8,["loading"]),l(v,{onClick:t[7]||(t[7]=a=>s.resetForm("Editform"))},{default:r(()=>[le]),_:1}),l(v,{onClick:t[8]||(t[8]=a=>s.resetForm("Editform"))},{default:r(()=>[re]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[B,n.value]])]),_:1})])}}};var ve=R(oe,[["__scopeId","data-v-3b2606ad"]]);export{ve as default};
