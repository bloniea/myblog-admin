import{p as O,j as P,k as J,i as Q,ad as R,r as W,X,Y,a2 as Z,a3 as G,q as ee,F as te,Z as ae,ae as le,a9 as oe,$ as se,a0 as ne,a1 as re,J as ie,o as r,c as m,L as g,a as l,w as o,M as u,u as s,P as v,Q as w,W as ce,a4 as de,K as _e,N as i,O as q,aa as ue,a5 as pe,a6 as me,f as c,a7 as ge}from"./vendor.0ff88f1f.js";/* empty css                   *//* empty css                           *//* empty css                      *//* empty css                  *//* empty css                  *//* empty css                  */import{s as be}from"./functions.2b6d8712.js";/* empty css                   *//* empty css                        */import{_ as ye}from"./plugin-vue_export-helper.21dcd24c.js";const fe={key:1,class:"articles"},he=i("\u9996\u9875"),ve=i("\u6587\u7AE0\u7BA1\u7406"),we=i("\u6587\u7AE0\u5217\u8868"),Ce={class:"head-con"},xe={class:"cat"},Ee=i(" \u5206\u7C7B: "),ke={class:"label"},qe=i(" \u6807\u7B7E: "),Ae=i("\u6DFB\u52A0\u6587\u7AE0"),ze={key:0},Ve={class:"img-box"},Be=i("\u4FEE\u6539"),$e=i("\u5220\u9664"),Te={setup(Le){const C=O(),y=P(!0),e=J({list:[],req:{query:"",pagesize:10,pagenum:1,category_id:"",label_ids:""},category_id:[],label_ids:[],total:0,categories:[],labels:[],pagesizes:[1,5,10,20]}),{proxy:p}=Q(),_=async()=>{y.value=!0;const{data:t}=await p.$axios.get("/adminApi/articles",{params:e.req});if(t.meta.status!==200)return c.error(t.meta.msg);y.value=!1,e.list=t.data.data,e.total=t.data.total};_(),(async()=>{const{data:t}=await p.$axios.get("/adminApi/categories");if(t.meta.status!==200)return c.error("\u83B7\u53D6\u5206\u7C7B\u51FA\u9519");e.categories=t.data})(),(async()=>{const{data:t}=await p.$axios.get("/adminApi/labels");if(t.meta.status!==200)return c.error("\u83B7\u53D6\u6807\u7B7E\u51FA\u9519");e.labels=t.data})();const x=()=>{e.req.category_id=e.category_id.toString(),e.req.label_ids=e.label_ids.toString(),_()},A=t=>{t||_()},z=t=>{e.req.pagesize=t,_()},V=t=>{e.req.pagenum=t,_()},B=async t=>{ge.confirm("\u786E\u8BA4\u5220\u9664\u6587\u7AE0\uFF1F","\u8B66\u544A",{distinguishCancelAndClose:!0,confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88"}).then(async()=>{c({dangerouslyUseHTMLString:!0,message:"\u6B63\u5728\u5220\u9664\u4E2D",type:"warning",duration:0});const{data:n}=await p.$axios.delete(`/adminApi/articles/${t}`);if(n.meta.status!==200)return c.error(n.meta.msg);c.closeAll(),c.success(n.meta.msg),_()}).catch(()=>{c.closeAll(),c.error("\u60A8\u53D6\u6D88\u4E86\u64CD\u4F5C")})},$=()=>{C.push({name:"AddArticle"})};R(()=>p.$route.path,()=>{_()});const T=t=>{C.push({name:"EditArticle",query:{id:t.id}})},L=t=>t.split(",");return(t,n)=>{const S=W("router-view"),f=X,N=Y,E=Z,k=G,b=ee,I=te,d=ae,K=le,M=oe,U=se,D=ne,j=re,F=ie;return t.$route.meta.article?(r(),m(S,{key:0})):(r(),g("div",fe,[l(N,{"separator-class":"el-icon-arrow-right"},{default:o(()=>[l(f,{to:{name:"Home"}},{default:o(()=>[he]),_:1}),l(f,null,{default:o(()=>[ve]),_:1}),l(f,null,{default:o(()=>[we]),_:1})]),_:1}),l(j,null,{default:o(()=>[u("div",Ce,[u("div",xe,[Ee,l(k,{placeholder:"\u8BF7\u9009\u62E9",modelValue:s(e).category_id,"onUpdate:modelValue":n[0]||(n[0]=a=>s(e).category_id=a),clearable:""},{default:o(()=>[(r(!0),g(v,null,w(s(e).categories,a=>(r(),m(E,{key:a.id,label:a.cat_name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),u("div",ke,[qe,l(k,{placeholder:"\u8BF7\u9009\u62E9",modelValue:s(e).label_ids,"onUpdate:modelValue":n[1]||(n[1]=a=>s(e).label_ids=a),multiple:""},{default:o(()=>[(r(!0),g(v,null,w(s(e).labels,a=>(r(),m(E,{key:a.id,label:a.label_name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),u("div",null,[l(I,{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",class:"input-with-select",modelValue:s(e).req.query,"onUpdate:modelValue":n[2]||(n[2]=a=>s(e).req.query=a),onKeyup:ce(x,["enter"]),onChange:A},{append:o(()=>[l(b,{icon:s(de),onClick:x},null,8,["icon"])]),_:1},8,["modelValue","onKeyup"])]),u("div",null,[l(b,{type:"primary",class:"add",onClick:$},{default:o(()=>[Ae]),_:1})])]),_e((r(),m(U,{data:s(e).list,border:"",style:{width:"100%"}},{default:o(()=>[l(d,{label:"#",type:"index"}),l(d,{prop:"title",label:"\u6807\u9898"}),l(d,{prop:"cat_name",label:"\u5206\u7C7B"}),l(d,{prop:"labels",label:"\u6807\u7B7E"},{default:o(a=>[a.row.labels?(r(),g("div",ze,[(r(!0),g(v,null,w(L(a.row.labels),(h,H)=>(r(),m(K,{key:H},{default:o(()=>[i(q(h),1)]),_:2},1024))),128))])):ue("",!0)]),_:1}),l(d,{prop:"img_url",label:"\u56FE\u7247"},{default:o(a=>[u("div",Ve,[l(M,{src:a.row.img_url,fit:"contain"},null,8,["src"])])]),_:1}),l(d,{prop:"img_source",label:"\u56FE\u7247\u6765\u6E90"}),l(d,{prop:"created_at",label:"\u521B\u5EFA\u65F6\u95F4"},{default:o(a=>[i(q(s(be)(a.row.created_at)),1)]),_:1}),l(d,{label:"\u64CD\u4F5C"},{default:o(a=>[l(b,{type:"primary",icon:s(pe),onClick:h=>T(a.row),size:"small"},{default:o(()=>[Be]),_:2},1032,["icon","onClick"]),l(b,{type:"danger",icon:s(me),onClick:h=>B(a.row.id),size:"small"},{default:o(()=>[$e]),_:2},1032,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[F,y.value]]),l(D,{onSizeChange:z,onCurrentChange:V,"current-page":s(e).req.pagenum,"page-sizes":s(e).pagesizes,"page-size":s(e).req.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:s(e).total},null,8,["current-page","page-sizes","page-size","total"])]),_:1})]))}}};var Qe=ye(Te,[["__scopeId","data-v-39774c6c"]]);export{Qe as default};
